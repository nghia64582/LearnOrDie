NÃ´ Ä‘Ã¹a cÃ¹ng Gemini API ğŸ¥³
KhaiButDauXuan
Giá»›i thiá»‡u
á» bÃ i viáº¿t trÆ°á»›c, tÃ´i Ä‘Ã£ giá»›i thiá»‡u vá» mÃ´ hÃ¬nh Gemma, má»™t bÆ°á»›c tiáº¿n má»›i trong xÃ¢y dá»±ng mÃ´ hÃ¬nh lá»›n Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Google. Trong bÃ i viáº¿t nÃ y, tÃ´i muá»‘n giá»›i thiá»‡u vá» Gemini, cÅ©ng lÃ  má»™t sáº£n pháº©m cá»§a Google. Sau Ä‘Ã³, ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu vÃ  sá»­ dá»¥ng Gemini API cung cáº¥p bá»Ÿi Google.

image.png

Gemini ğŸ¤–
Gemini lÃ  má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n cá»§a Google AI. NÃ³ Ä‘Æ°á»£c Ä‘Ã o táº¡o trÃªn má»™t táº­p dá»¯ liá»‡u vÄƒn báº£n vÃ  mÃ£ khá»•ng lá»“, cho phÃ©p nÃ³ giao tiáº¿p vÃ  táº¡o ra vÄƒn báº£n giá»‘ng con ngÆ°á»i Ä‘á»ƒ Ä‘Ã¡p láº¡i cÃ¡c cÃ¢u há»i vÃ  yÃªu cáº§u cá»§a con ngÆ°á»i. HÃ£y coi nÃ³ nhÆ° má»™t cÃ´ng cá»¥ ngÃ´n ngá»¯ máº¡nh máº½ cÃ³ thá»ƒ giÃºp má»i ngÆ°á»i thá»±c hiá»‡n nhiá»u nhiá»‡m vá»¥ khÃ¡c nhau, cháº³ng háº¡n nhÆ°:

Tráº£ lá»i cÃ¡c cÃ¢u há»i má»™t cÃ¡ch giÃ u thÃ´ng tin, ngay cáº£ khi chÃºng cÃ³ káº¿t thÃºc má»Ÿ, mang tÃ­nh thá»­ thÃ¡ch hoáº·c láº¡ lÃ¹ng.
Táº¡o cÃ¡c Ä‘á»‹nh dáº¡ng vÄƒn báº£n sÃ¡ng táº¡o khÃ¡c nhau, nhÆ° thÆ¡, mÃ£, ká»‹ch báº£n, báº£n nháº¡c, email, thÆ°, v.v.
Tráº£ lá»i cÃ¡c cÃ¢u há»i cá»§a báº¡n má»™t cÃ¡ch giÃ u thÃ´ng tin, ngay cáº£ khi chÃºng cÃ³ káº¿t thÃºc má»Ÿ, mang tÃ­nh thá»­ thÃ¡ch hoáº·c láº¡ lÃ¹ng.
Báº¡n cÃ³ thá»ƒ thá»­ Gemini trÃªn web hoáº·c Ä‘iá»‡n thoáº¡i cá»§a mÃ¬nh. image.png

Gemini API ğŸ‘¾
NgoÃ i viá»‡c Ä‘Æ°ojwc sá»­ dá»¥ng trÃªn web hoáº·c Ä‘iá»‡n thoáº¡i, Google cung cáº¥p SDK Ä‘á»ƒ sá»­ dá»¥ng Gemini API Ä‘á»ƒ nhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ má»™t cÃ¡ch linh hoáº¡t. BÃ¢y giá», ta sáº½ thá»­ sá»­ dá»¥ng tÃ­nh nÄƒng mÃ  Google Ä‘Ã£ cung cáº¥p. Ta sáº½ Ä‘i qua cÃ¡c bÆ°á»›c nhÆ° sau:

CÃ i Ä‘áº·t mÃ´i trÆ°á»ng vÃ  cÃ¡ch láº¥y token Ä‘á»ƒ truy cáº­p vÃ o API.
Táº¡o pháº£n há»“i chá»¯ tá»« yÃªu cáº§u chá»¯ (Generate **text from text **input).
Táº¡o pháº£n há»“i chá»¯ tá»« yÃªu cáº§u hÃ¬nh (Generate text from image input).
CÃ i Ä‘áº·t mÃ´i trÆ°á»ng
Äá»ƒ cÃ i Ä‘áº·t Python SDK Ä‘á»ƒ sá»­ dá»¥ng GeminiAPI thÃ´ng qua gÃ³i google-generativeai. Ta thá»±c hiá»‡n Ä‘iá»u nÃ y báº±ng cÃº phÃ¡p:

pip install -q -U google-generativeai

Äá»ƒ láº¥y token cÃ³ thá»ƒ truy cáº­p vÃ o Gemini, ta truy cáº­p vÃ o Ä‘Ã¢y Ä‘á»ƒ thá»±c hiá»‡n viá»‡c láº¥y mÃ£. Sau khi Ä‘Ã£ truy cáº­p vÃ o Studio, ta nhÃ¬n vá» phÃ­a tay trÃ¡i sáº½ tháº¥y má»™t nÃºt Ä‘á»ƒ táº¡o API token. image.png Ta gá»i cÃ¡c thÆ° viá»‡n vÃ  xÃ¢y dá»±ng cÃ¡c hÃ m cáº§n thiáº¿t

import pathlib
import textwrap

import google.generativeai as genai

from IPython.display import display
from IPython.display import Markdown


def to_markdown(text):
  text = text.replace('â€¢', '  *')
  return Markdown(textwrap.indent(text, '> ', predicate=lambda _: True))

Ta nháº­p API token vá»«a táº¡o Ä‘á»ƒ khai thÃ¡c mÃ´ hÃ¬nh

GOOGLE_API_KEY = "CÃ¡c báº¡n nháº­p API Token vÃ o Ä‘Ã¢y"

genai.configure(api_key=GOOGLE_API_KEY)

Thá»±c nghiá»‡m
Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ thá»±c hiá»‡n 2 thÃ­ nghiá»‡m sau:

Thá»±c hiá»‡n text from text: yÃªu cáº§u Gemini tráº£ vá» káº¿t quáº£ chá»¯ khi nháº­n yÃªu cáº§u chá»¯ cá»§a ta. VÃ­ dá»¥ nhÆ°, há»i-Ä‘Ã¡p, yÃªu cáº§u truy xuáº¥t thÃ´ng tin, yÃªu cáº§u tÃ³m táº¯m, ... Ta cÃ³ thá»ƒ liÃªn tÆ°á»Ÿng Ä‘áº¿n á»©ng dá»¥ng ná»•i tiáº¿ng nhÆ° ChatGPT.
Thá»±c hiá»‡n text from img: yÃªu cáº§u Gemini tráº£ vá» káº¿t quáº£ chá»¯ khi nháº­n yÃªu cáº§u hÃ¬nh cá»§a ta. Cá»¥ thá»ƒ hÆ¡n, khi ta Ä‘Æ°a Gemini má»™t hÃ¬nh áº£nh, nÃ³ sáº½ mÃ´ táº£ ná»™i dung cá»§a bá»©c áº£nh áº¥y.
TrÆ°á»›c háº¿t, ta sáº½ xem cÃ¡c mÃ´ hÃ¬nh khÃ¡c mÃ  Gemini cung cáº¥p:

for m in genai.list_models():
  if 'generateContent' in m.supported_generation_methods:
    print(m.name)
    """
            Káº¿t quáº£   
            models/gemini-1.0-pro
            models/gemini-1.0-pro-001
            models/gemini-1.0-pro-latest
            models/gemini-1.0-pro-vision-latest
            models/gemini-pro
            models/gemini-pro-vision
      """

Text from text
Ta sá»­ dá»¥ng mÃ´ hÃ¬nh models/gemini-1.0-pro trong bÃ i viáº¿t nÃ y.

model = genai.GenerativeModel('gemini-1.0-pro')
model

PhÆ°Æ¡ng thá»©c generate_content cÃ³ thá»ƒ xá»­ lÃ½ nhiá»u trÆ°á»ng há»£p sá»­ dá»¥ng khÃ¡c nhau, bao gá»“m trÃ² chuyá»‡n nhiá»u lÆ°á»£t (multi-turn) vÃ  Ä‘áº§u vÃ o Ä‘a phÆ°Æ¡ng thá»©c (multimodal), tÃ¹y thuá»™c vÃ o nhá»¯ng gÃ¬ mÃ´ hÃ¬nh cÆ¡ báº£n há»— trá»£. CÃ¡c kiá»ƒu mÃ¡y hiá»‡n cÃ³ chá»‰ há»— trá»£ vÄƒn báº£n vÃ  hÃ¬nh áº£nh lÃ m Ä‘áº§u vÃ o vÃ  vÄƒn báº£n lÃ m Ä‘áº§u ra.

Theo máº·c Ä‘á»‹nh, mÃ´ hÃ¬nh tráº£ vá» pháº£n há»“i sau khi hoÃ n thÃ nh toÃ n bá»™ quÃ¡ trÃ¬nh táº¡o. Báº¡n cÅ©ng cÃ³ thá»ƒ truyá»n phÃ¡t pháº£n há»“i khi nÃ³ Ä‘Æ°á»£c táº¡o vÃ  mÃ´ hÃ¬nh sáº½ tráº£ vá» cÃ¡c pháº§n pháº£n há»“i ngay khi chÃºng Ä‘Æ°á»£c táº¡o.

Äá»ƒ stream 1 pháº£n há»“i, sá»­ dá»¥ng cÃº phÃ¡p GenerativeModel.generate_content(..., stream=True)

VÃ­ dá»¥: Pháº£n há»“i ngay láº­p tá»©c

%%time
response = model.generate_content("Táº¡i sao TrÃ¡i Äáº¥t quay xung quanh máº·t trá»i?")
response

"""
CPU times: user 117 ms, sys: 8.24 ms, total: 126 ms
Wall time: 6.74 s
response:
GenerateContentResponse(
    done=True,
    iterator=None,
    result=glm.GenerateContentResponse({'candidates': [{'content': {'parts': [{'text': 'TrÃ¡i Äáº¥t quay quanh Máº·t Trá»i vÃ¬ lá»±c háº¥p dáº«n.\n\nKhi Máº·t Trá»i hÃ¬nh thÃ nh, má»™t Ä‘Ä©a váº­t cháº¥t bá»“i tá»¥ xung quanh nÃ³. ÄÄ©a nÃ y chá»©a chá»§ yáº¿u lÃ  hydro vÃ  heli, cÃ¹ng vá»›i má»™t lÆ°á»£ng nhá» cÃ¡c nguyÃªn tá»‘ náº·ng hÆ¡n. Khi Ä‘Ä©a bá»“i tá»¥, cÃ¡c háº¡t váº­t cháº¥t va cháº¡m vá»›i nhau, giáº£i phÃ³ng nÄƒng lÆ°á»£ng vÃ  lÃ m nÃ³ng Ä‘Ä©a.\n\ná» trung tÃ¢m cá»§a Ä‘Ä©a, váº­t cháº¥t trá»Ÿ nÃªn Ä‘á»§ nÃ³ng Ä‘á»ƒ pháº£n á»©ng háº¡t nhÃ¢n diá»…n ra. CÃ¡c pháº£n á»©ng nÃ y giáº£i phÃ³ng má»™t lÆ°á»£ng nÄƒng lÆ°á»£ng khá»•ng lá»“, khiáº¿n Máº·t Trá»i trá»Ÿ thÃ nh má»™t ngÃ´i sao.\n\nKhi Máº·t Trá»i hÃ¬nh thÃ nh, pháº§n váº­t cháº¥t cÃ²n láº¡i trong Ä‘Ä©a bá»“i tá»¥ báº¯t Ä‘áº§u tÃ­ch tá»¥ láº¡i vá»›i nhau, hÃ¬nh thÃ nh nÃªn cÃ¡c hÃ nh tinh, bao gá»“m cáº£ TrÃ¡i Äáº¥t. TrÃ¡i Äáº¥t Ä‘Æ°á»£c táº¡o thÃ nh tá»« cÃ¡c váº­t liá»‡u náº·ng hÆ¡n trong Ä‘Ä©a bá»“i tá»¥, bao gá»“m sáº¯t, silic vÃ  oxy.\n\nKhi TrÃ¡i Äáº¥t hÃ¬nh thÃ nh, nÃ³ báº¯t Ä‘áº§u quay quanh Máº·t Trá»i vÃ¬ lá»±c háº¥p dáº«n. Lá»±c háº¥p dáº«n lÃ  lá»±c mÃ  báº¥t ká»³ hai váº­t thá»ƒ nÃ o cÃ³ khá»‘i lÆ°á»£ng cÅ©ng tÃ¡c Ä‘á»™ng lÃªn nhau. Khá»‘i lÆ°á»£ng cá»§a Máº·t Trá»i ráº¥t lá»›n, vÃ¬ váº­y nÃ³ táº¡o ra má»™t lá»±c háº¥p dáº«n ráº¥t máº¡nh tÃ¡c Ä‘á»™ng lÃªn TrÃ¡i Äáº¥t. Lá»±c nÃ y giá»¯ cho TrÃ¡i Äáº¥t quay quanh Máº·t Trá»i theo quá»¹ Ä‘áº¡o hÃ¬nh elip.'}], 'role': 'model'}, 'finish_reason': 1, 'index': 0, 'safety_ratings': [{'category': 9, 'probability': 1, 'blocked': False}, {'category': 8, 'probability': 1, 'blocked': False}, {'category': 7, 'probability': 1, 'blocked': False}, {'category': 10, 'probability': 1, 'blocked': False}], 'token_count': 0, 'grounding_attributions': []}], 'prompt_feedback': {'safety_ratings': [{'category': 9, 'probability': 1, 'blocked': False}, {'category': 8, 'probability': 1, 'blocked': False}, {'category': 7, 'probability': 1, 'blocked': False}, {'category': 10, 'probability': 1, 'blocked': False}], 'block_reason': 0}}),
)
"""

Pháº£n há»“i vá»›i stream

%%time
response_st = model.generate_content("Táº¡i sao TrÃ¡i Äáº¥t quay xung quanh máº·t trá»i?", stream=True)

for chunk in response_st:
  print(chunk.text)
  print("_"*50)
  
 """
 TrÃ¡i Äáº¥t quay xung quanh Máº·t Trá»i chá»§ yáº¿u lÃ  do hai
__________________________________________________
 lÃ½ do:

**1. Lá»±c háº¥p dáº«n:**

* Máº·t Trá»i lÃ  ngÃ´i sao cÃ³ khá»‘i lÆ°á»£ng ráº¥t lá»›n.
* Theo Ä‘á»‹nh luáº­t
__________________________________________________
 háº¥p dáº«n cá»§a Newton, hai váº­t thá»ƒ cÃ³ khá»‘i lÆ°á»£ng cÃ ng lá»›n thÃ¬ lá»±c háº¥p dáº«n giá»¯a chÃºng cÃ ng máº¡nh.
* Máº·t Trá»i cÃ³ khá»‘i lÆ°á»£ng lá»›n hÆ¡n TrÃ¡i Äáº¥t ráº¥t nhiá»u, táº¡o ra lá»±c háº¥p dáº«n máº¡nh máº½.

**2. Báº£o toÃ n Ä‘á»™ng lÆ°á»£ng gÃ³c:**

* Há»‡ Máº·t Tr
__________________________________________________
á»i ban Ä‘áº§u lÃ  má»™t Ä‘Ã¡m mÃ¢y khÃ­ vÃ  bá»¥i Ä‘ang quay.
* Khi Ä‘Ã¡m mÃ¢y nÃ y sá»¥p Ä‘á»• Ä‘á»ƒ táº¡o thÃ nh Máº·t Trá»i, váº­t cháº¥t á»Ÿ bÃªn ngoÃ i Ä‘Ã¡m mÃ¢y pháº£i di chuyá»ƒn nhanh hÆ¡n Ä‘á»ƒ báº£o toÃ n Ä‘á»™ng lÆ°á»£ng gÃ³c.
* Váº­t cháº¥t nÃ y cuá»‘i cÃ¹ng táº¡o thÃ nh cÃ¡c hÃ nh tinh, bao gá»“m TrÃ¡i Äáº¥t, chuyá»ƒn Ä‘á»™ng xung quanh Máº·t Trá»i trÃªn cÃ¹ng má»™t máº·t pháº³ng vÃ  cÃ¹ng hÆ°á»›ng.

VÃ¬ váº­y, sá»± káº¿t há»£p giá»¯a lá»±c háº¥p dáº«n cá»§a Máº·t Trá»i vÃ  Ä‘á»™ng lÆ°á»£ng gÃ³c báº£o toÃ n Ä‘Ã£ khiáº¿n TrÃ¡i Äáº¥t vÃ  cÃ¡c hÃ nh tinh khÃ¡c quay quanh Máº·t Trá»i trong
__________________________________________________
 quá»¹ Ä‘áº¡o cá»§a chÃºng.
__________________________________________________
CPU times: user 152 ms, sys: 11.8 ms, total: 164 ms
Wall time: 8.28 s
 """

Sá»­ dá»¥ng hÃ m to_markdown vá»«a Ä‘á»‹nh nghÄ©a Ä‘á»ƒ káº¿t quáº£ trÃ´ng Ä‘áº¹p máº¯t há»£p:

to_markdown(response.text)

NgoÃ i ra, ta cÃ³ thá»ƒ xem Ä‘á»™ an toÃ n vá» ná»™i dung ta vá»«a nháº­p vÃ o thÃ´ng qua:

response.prompt_feedback

"""
safety_ratings {
  category: HARM_CATEGORY_SEXUALLY_EXPLICIT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HATE_SPEECH
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_HARASSMENT
  probability: NEGLIGIBLE
}
safety_ratings {
  category: HARM_CATEGORY_DANGEROUS_CONTENT
  probability: NEGLIGIBLE
}

"""

Text from img
Gemini cung cáº¥p má»™t mÃ´ hÃ¬nh Ä‘a phÆ°Æ¡ng thá»©c (gemini-pro-vision) cháº¥p nháº­n cáº£ vÄƒn báº£n, hÃ¬nh áº£nh vÃ  Ä‘áº§u vÃ o. GenerativeModel.generate_content Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ cÃ¡c lá»i nháº¯c Ä‘a phÆ°Æ¡ng thá»©c (multimodal prompts) vÃ  tráº£ vá» káº¿t quáº£ vÄƒn báº£n.

Trong thá»­ nghiá»‡m nÃ y, ta táº£i má»™t áº£nh lÃªn Colab Ä‘á»ƒ thá»­ chá»©c nÄƒngimage.png

Ta cÃ i Ä‘áº·t mÃ´ hÃ¬nh gemini-pro-vision

v_model = genai.GenerativeModel('gemini-pro-vision')
v_model

Äá»ƒ mÃ´ hÃ¬nh mÃ´ táº£ ná»™i dung cá»§a bá»©c hÃ¬nh, ta thá»±c hiá»‡n nhÆ° sau

response = v_model.generate_content(img)

to_markdown(response.text)

"""
A Turkish breakfast is a feast of delicious dishes that are meant to be shared with family and friends. The table is typically laden with a variety of breads, cheeses, olives, tomatoes, cucumbers, and other fresh vegetables. There are also often eggs, sausage, and other meat dishes. The meal is typically rounded out with tea or coffee and a sweet dessert.

Turkish breakfast is a social occasion, and it is often enjoyed at a leisurely pace. It is a time to catch up with loved ones and to enjoy the simple pleasures of life.

If you are ever lucky enough to be invited to a Turkish breakfast, be sure to come hungry! You will be treated to a delicious and unforgettable meal.
"""

Note: CÃ¡c chá»©c nÄƒng khÃ¡c cÅ©ng Ä‘Æ°á»£c nÃªu ra vÃ  hÆ°á»›ng dáº«n táº¡i [2].

Cáº£m Æ¡n cÃ¡c báº¡n Ä‘Ã£ Ä‘á»c tá»›i Ä‘Ã¢y, tÃ´i mong ráº±ng bÃ i viáº¿t nÃ y sáº½ lÃ  má»™t pháº§n trong kho kiáº¿n thá»©c cá»§a báº¡n. TrÆ°á»›c khi rá»i Ä‘i:

ğŸ‘‰ Cho mÃ¬nh xin má»™t upvote vÃ  má»™t follow. Äiá»u nÃ y sáº½ giÃºp Ã­ch cho mÃ¬nh ráº¥t nhiá»u.

ğŸ‘‰ Chi tiáº¿t vá» triá»ƒn khai cá»§a mÃ¬nh Ä‘á»ƒ táº¡i Ä‘Ã¢y: Colab

ğŸ‘‰ CÃ¡c báº¡n cÃ³ thá»ƒ theo dÃµi mÃ¬nh thÃªm táº¡i Ä‘Ã¢y: Linkedin | Github